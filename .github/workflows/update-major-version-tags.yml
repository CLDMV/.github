# CLDMV/.github/.githujobs:
name: 📌 Update Major Version Tags

on:
  workflow_call:
    inputs:
      create_documentation:
        description: "Whether to create/update VERSION_TAGS.md documentation"
        required: false
        type: boolean
        default: true
    outputs:
      major-version:
        description: "The major version tag that was updated"
        value: ${{ jobs.update-tags.outputs.major-version }}
      minor-version:
        description: "The minor version tag that was updated"
        value: ${{ jobs.update-tags.outputs.minor-version }}
      updated:
        description: "Whether tags were successfully updated"
        value: ${{ jobs.update-tags.outputs.updated }}
  push:

jobs:
  check-version-tags:
    name: "🔍 Check for Version Tags"
    runs-on: ubuntu-latest
    if: github.event_name == 'push'
    outputs:
      has_version_tags: ${{ steps.check.outputs.has_version_tags }}
      version_tags: ${{ steps.check.outputs.version_tags }}
    steps:
      - name: Check for version tags
        id: check
        uses: ./.github/actions/git/steps/check-version-tags

  update-tags:
    name: "🚀 Execute Tag Updates"
    needs: [check-version-tags]
    if: always() && (github.event_name == 'workflow_call' || needs.check-version-tags.outputs.has_version_tags == 'true')
    uses: ./.github/workflows/ci-jobs.yml
    with:
      package_name: "version-tags" # Dummy value since this is just for tagging
      run_update_major_version_tags: true
      create_documentation: ${{ inputs.create_documentation }}
