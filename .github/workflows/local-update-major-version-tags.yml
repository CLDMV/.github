# This repository's workflow to update version tags
name: ðŸ·ï¸ Update Version Tags

on:
  release:
    types: [published]
  push:

jobs:
  check-version-tags:
    name: "ï¿½ Check for Version Tags"
    runs-on: ubuntu-latest
    outputs:
      has_version_tags: ${{ steps.check.outputs.has_version_tags }}
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
      
      - name: Check for version tags pointing to this commit
        id: check
        run: |
          # Check if any version tags point to the current commit
          if git tag --points-at ${{ github.sha }} | grep -E '^v[0-9]+\.[0-9]+\.[0-9]+$'; then
            echo "has_version_tags=true" >> $GITHUB_OUTPUT
          else
            echo "has_version_tags=false" >> $GITHUB_OUTPUT
          fi

  update-tags:
    name: "ðŸ“Œ Update Major Version Tags"
    needs: check-version-tags
    if: github.event_name == 'release' || needs.check-version-tags.outputs.has_version_tags == 'true'
    uses: ./.github/workflows/update-major-version-tags.yml
    with:
      create_documentation: true
